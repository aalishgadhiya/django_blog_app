{% extends "base.html" %}

{% block content %}


<div id='blogDetailContainer' data-blog-id='{{ blog_data.id }}'></div>
<div class='container-fluid d-flex justify-content-center align-items-lg-center' style='height:40vh;background-color:#FAF9F6'>
   <div class='row'>
       <div class='col-12'>
             <div class='text-center'>
                <h1 class='display-4'>{{blog_data.title}}</h1>
                <hr>
                <div class='d-flex justify-content-center'>
                    <h6 class='m-2'>{{blog_data.post_date | date:'M,d Y'}}</h6>
                    <h6 class='m-2'> - {{blog_data.author | title}}</h6>
                </div>
             </div>
       </div>
   </div>
</div>

<div class='container mt-5 mb-5'>
     <div class='row'>
        <div class='col-12'>
            <h5>
                Description:
            </h5>
            <div>
                <p class='lead text-start-50'>
                    {{blog_data.content}}
                </p>
            </div> 
            <div class='mt-3'>
                 <h5> Comments: </h5>
                 {% if comments %}
                    <div id='commentsContainer'>
                        {% for comment in comments %}
                          <hr>
                           <p>{{comment.description}} - {{comment.user}} - {{comment.comment_post_date | date:'M,d Y'}}</p>
                          <hr>
                        {% endfor %}
                    </div>
                 {% else %}
                   <p>No comments available.</p>
                 {% endif %}
                 <h5 class='text-muted'>Post Your Comment Here: </h5>
                 <form class="col-6" id='comment_form' method="post">
                    {% csrf_token %}
                     <div class="form-floating mb-3">
                       <textarea class="form-control" placeholder="Please Enter A Comment" id="user_comment" style="height: 100px" name='user_comment' required></textarea>
                       <label for="user_comment">Comment</label>
                     </div>
                     <p>Enter Comment about Blog Here...</p>
                     <button type="submit" class="btn btn-primary mt-4">Submit</button>
                 </form> 
            </div>
        </div>
     </div>
</div>
 {% comment %} <script>
   let blog_id = $('#blogDetailContainer').data('blog-id')
   console.log(blog_id);
   
   $(document).ready(function () { 
    $('#comment_form').submit(function(e){
       e.preventDefault();
       $.ajex({
           type: 'POST',
           url: `/bloggerdetail/${blog_id}`,
           data:$('#comment_form').serialize(),
           success:function(response){
            
              if(response.success){
                var newComment = '<div class="comment"><p><strong>' + response.user_name + '</strong> (' + response.comment_date + '): ' + response.comment_text + '</p></div>';
                $('#commentsContainer').prepend(newComment);

                $('#user_comment').val('');
              }
           },
           error: function(error){
            console.log(error);
           }
        });
    });
}); 
</script>  {% endcomment %}
{% endblock  %}